--names of top3 employees that had biggest sales in each category
SELECT * FROM(
    SELECT CONCAT(E.FIRST_NAME, CONCAT(' ', E.LAST_NAME)) name,
           PC.CATEGORY_NAME category,
           SUM(P.LIST_PRICE * OI.QUANTITY) sum,
           RANK() OVER (PARTITION BY CATEGORY_NAME ORDER BY SUM(P.LIST_PRICE * OI.QUANTITY)) rank
    FROM EMPLOYEES E JOIN ORDERS O ON E.EMPLOYEE_ID = O.SALESMAN_ID
        JOIN ORDER_ITEMS OI on O.ORDER_ID = OI.ORDER_ID
        JOIN PRODUCTS P on OI.PRODUCT_ID = P.PRODUCT_ID
        JOIN PRODUCT_CATEGORIES PC on P.CATEGORY_ID = PC.CATEGORY_ID
    GROUP BY E.FIRST_NAME, E.LAST_NAME, PC.CATEGORY_NAME) tab
WHERE rank <= 3;