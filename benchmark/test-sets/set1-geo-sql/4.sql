-- number and count of different products in each country inventories
SELECT COUNTR.COUNTRY_ID, PC.CATEGORY_NAME, SUM(I.QUANTITY) quantity, COUNT(P.PRODUCT_ID) diff_products
FROM WAREHOUSES W
    JOIN LOCATIONS L on W.LOCATION_ID = L.LOCATION_ID
    JOIN COUNTRIES COUNTR on L.COUNTRY_ID = COUNTR.COUNTRY_ID
    JOIN INVENTORIES I on W.WAREHOUSE_ID = I.WAREHOUSE_ID
    JOIN PRODUCTS P on I.PRODUCT_ID = P.PRODUCT_ID
    JOIN PRODUCT_CATEGORIES PC on P.CATEGORY_ID = PC.CATEGORY_ID
GROUP BY COUNTR.COUNTRY_ID, PC.CATEGORY_NAME;