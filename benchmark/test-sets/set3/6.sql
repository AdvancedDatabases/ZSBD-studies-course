/*
Usun pracownikow ktorzy pracuja krocej niz rok i obsluzyli mniej niz
trzy zamowienia. Wpisz ich dane do tabeli EX_EMPLOYEES  ~ 2000
*/
CREATE TABLE EX_EMPLOYEES as select * from EMPLOYEES where 1=0;

INSERT INTO EX_EMPLOYEES
SELECT * FROM EMPLOYEES
WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID
    FROM EMPLOYEES e
    WHERE ROUND(MONTHS_BETWEEN(sysdate, e.HIRE_DATE),0) <= 12
        AND e.EMPLOYEE_ID IN (SELECT SALESMAN_ID FROM (
                SELECT SALESMAN_ID, COUNT(*) ORDERS_NUMBER
                FROM ORDERS GROUP BY SALESMAN_ID)
            WHERE ORDERS_NUMBER < 3));

DELETE
FROM EMPLOYEES e
WHERE ROUND(MONTHS_BETWEEN(sysdate, e.HIRE_DATE),0) <= 12
    AND e.EMPLOYEE_ID IN (SELECT SALESMAN_ID FROM (
            SELECT SALESMAN_ID, COUNT(*) ORDERS_NUMBER
            FROM ORDERS GROUP BY SALESMAN_ID)
        WHERE ORDERS_NUMBER < 3);

----- CHECK
-- 2266 employees
-- 246, 251 will be deleted
-- 247 wont be deleted
/*
SELECT * FROM EMPLOYEES
WHERE EMPLOYEE_ID IN (246, 251, 247);

SELECT * FROM EX_EMPLOYEES
WHERE EMPLOYEE_ID IN (246, 251, 247);
*/
